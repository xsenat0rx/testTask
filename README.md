# Chat Application

–ß–∞—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π real-time –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π, –ø–æ–∏—Å–∫–æ–º –ø–æ —á–∞—Ç–∞–º –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏ –∏ –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Docker.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (JWT)
- Real-time —á–∞—Ç —á–µ—Ä–µ–∑ SignalR (`/chathub`)
- RESTful API –¥–ª—è —á–∞—Ç–æ–≤ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ü–æ–∏—Å–∫ –ø–æ —á–∞—Ç–∞–º –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
- PostgreSQL (Entity Framework Core)
- Swagger API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ Serilog (–≤ SQLite)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ unit-—Ç–µ—Å—Ç—ã (xUnit)
- Docker Compose –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```sh
git clone https://github.com/xsenat0rx/testTask.git
cd testTask
```

### 2. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```sh
docker compose up --build
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É [http://localhost:8080](http://localhost:8080).

> **‚ÑπÔ∏è –û–∫—Ä—É–∂–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ `web_api` (—Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã JWT –∏ –¥—Ä.) –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä—è–º–æ –≤ —Ñ–∞–π–ª–µ `docker-compose.yml` –≤ —Å–µ–∫—Ü–∏–∏ `environment`.**

---

## üìù API Endpoints

| Method | Endpoint                                  | –û–ø–∏—Å–∞–Ω–∏–µ                  |
| ------ | ----------------------------------------- | ------------------------- |
| POST   | /api/auth/register                        | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  |
| POST   | /api/auth/login                           | –í—Ö–æ–¥ (JWT)                |
| GET    | /api/chats                                | –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| POST   | /api/chats                                | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —á–∞—Ç         |
| GET    | /api/chats/{id}/messages                  | –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ  |
| POST   | /api/chats/{id}/messages                  | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ       |
| GET    | /api/chats/search?query=...               | –ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é   |
| GET    | /api/chats/{id}/messages/search?query=... | –ü–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ    |

### SignalR Hub

- **/chathub**
  - `JoinChat(int chatId)`
  - `SendMessage(int chatId, string text)`

---

## üîç –ü–æ–∏—Å–∫

- **–ß–∞—Ç—ã:**  
  `GET /api/chats/search?query=—Ç–µ–∫—Å—Ç`
- **–°–æ–æ–±—â–µ–Ω–∏—è:**  
  `GET /api/chats/{chatId}/messages/search?query=—Ç–µ–∫—Å—Ç`

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger)

Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ –∞–¥—Ä–µ—Å—É:  
[http://localhost:8080/swagger](http://localhost:8080/swagger)

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

#### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**POST `/api/auth/register`**  
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```json
{
  "username": "Anna",
  "email": "anna@yandex.ru",
  "password": "AnnaPassword"
}
```

**POST `/api/auth/login`**  
–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–ª—É—á–µ–Ω–∏–µ JWT.

```json
{
  "email": "anna@yandex.ru",
  "password": "AnnaPassword"
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "isSuccess": true,
  "token": "jwt-token",
  "message": "Login successful"
}
```

---

#### –ß–∞—Ç—ã

**GET `/api/chats`**  
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**POST `/api/chats`**  
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —á–∞—Ç.

```json
{
  "name": "New Chat"
}
```

**GET `/api/chats/{id}/messages`**  
–ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–µ.

**POST `/api/chats/{id}/messages`**  
–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç.

```json
{
  "text": "–ü—Ä–∏–≤–µ—Ç!"
}
```

---

#### –ü–æ–∏—Å–∫

**GET `/api/chats/search?query=—Ç–µ–∫—Å—Ç`**  
–ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é.

**GET `/api/chats/{chatId}/messages/search?query=—Ç–µ–∫—Å—Ç`**  
–ü–æ–∏—Å–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ.

---

#### SignalR Hub

- **/chathub** ‚Äî real-time –æ–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.
- –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ SignalR –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ JWT-—Ç–æ–∫–µ–Ω –≤ query-–ø–∞—Ä–∞–º–µ—Ç—Ä–µ `access_token`.

---

#### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ JWT-—Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:

```
Authorization: Bearer <–≤–∞—à —Ç–æ–∫–µ–Ω>
```

–í Swagger UI –Ω–∞–∂–º–∏—Ç–µ "Authorize" –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à JWT-—Ç–æ–∫–µ–Ω –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞—â–∏—â—ë–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

---

#### –ö–æ–Ω—Ñ–∏–≥

**GET `/config`**  
–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏).

---

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- .NET 8
- ASP.NET Core Web API
- SignalR
- Entity Framework Core + PostgreSQL
- Serilog (–ª–æ–≥–∏ –≤ `Logs/log.db`)
- xUnit (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ unit-—Ç–µ—Å—Ç—ã)

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```sh
dotnet test
```

---

## üê≥ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [.NET 8 SDK](https://dotnet.microsoft.com/download)
- [Docker](https://www.docker.com/)
- [PostgreSQL](https://www.postgresql.org/) (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker Compose)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

## üë• –ê–≤—Ç–æ—Ä—ã

- xsenat0rx
- skyd4emon

---
